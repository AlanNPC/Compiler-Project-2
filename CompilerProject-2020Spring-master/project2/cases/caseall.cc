case 1	
	C<4, 16>[i, j] = A<4, 16>[i, j] * B<4, 16>[i, j] + 1.0;
	dA<4, 16>[i, j] = dC<4, 16>[i, j] * B<4, 16>[i, j];

case 2
	B<4, 16>[i, j] = A<4, 16>[i, j] * A<4, 16>[i, j] + 1.0;
	dA<4, 16>[i, j] = dB<4, 16>[i, j] * A<4, 16>[i, j] + A<4, 16>[i, j] * dB<4, 16>[i, j];

case 3
	C<4, 16>[i, j] = A<4, 16>[i, k] * B<16, 16>[k, j];
	dA<4, 16>[i, k] = dC<4, 16>[i, j] * B<16, 16>[k, j];

case 4
	A<16, 32>[i, j] = B<16, 32>[i, k] * C<32, 32>[k, j];
	dB<16, 32>[i, k] = dA<16, 32>[i, j] * C<32, 32>[k, j];
	dC<32, 32>[k, j] = dA<16, 32>[i, j] * B<16, 32>[i, k];

case 5
	A<16, 32>[i, j] =  B<16, 32, 4>[i, k, l] * C<32, 32>[k, j] * D<4, 32>[l, j];
	dB<16, 32, 4>[i, k, l] = dA<16, 32>[i, j] * C<32, 32>[k, j] * D<4, 32>[l, j];

case 6
	A<2, 8, 5, 5>[n, k, p, q] = B<2, 16, 7, 7>[n, c, p + r, q + s] * C<8, 16, 3, 3>[k, c, r, s];
	dB<2, 16, 7, 7>[n, c, h, w] = select((h - p >= 0) && (w - q >= 0) && (h - p < 3) && (w - q < 3), dA<2, 8, 5, 5>[n, k, p, q] * C<8, 16, 3, 3>[k, c, h - p, w - q], 0.0);

case 7	
	B<16, 32>[i, j] = A<32, 16>[j, i];
	dA<32, 16>[j, i] = dB<16, 32>[i, j];

case 8
	B<32>[i] = A<2, 16>[i/16, i%16];
	dA<2, 16>[i, j] = dB<32>[i * 16 + j];

case 9
	B<4, 6>[i, j] = A<4>[i];
	dA<4>[i] = dB<4, 6>[i, j];

case 10
	A<8, 8>[i, j] = (B<10, 8>[i, j] + B<10, 8>[i + 1, j] + B<10, 8>[i + 2, j]) / 3.0;
	dB<10, 8>[i, j] = (select(i >= 0 && i < 8, dA<8, 8>[i, j], 0.0) + select(i >= 1 && i < 9, dA<8, 8>[i - 1, j], 0.0) + select(i >= 2 && i < 10, dA<8, 8>[i - 2, j], 0.0)) / 3.0;